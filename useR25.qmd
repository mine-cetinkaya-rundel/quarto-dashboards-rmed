---
title: "useR! 2025"
format: 
  dashboard:
    nav-buttons:
      - icon: github
        href: https://github.com/mine-cetinkaya-rundel/quarto-dashboards-rmed      
brand:
  light: brand/light-brand.yml
  dark: brand/dark-brand.yml
---

```{r}
#| label: load-packages
library(tidyverse)
library(gt)
library(scales)
library(ggwordcloud)
```

```{r}
#| label: load-data
program <- read_csv("data/program.csv")
```

```{r}
#| label: make-schedule
#| include: false
make_schedule <- function(x, color){
  
  fill_color <- paste0(color, "50")

  x |>
  gt(rowname_col = "time", groupname_col = "session") |>
  fmt_markdown(columns = c(info, speakers)) |>
  tab_style(
    style = list(
      cell_fill(color = fill_color), 
      cell_text(weight = "bold", size = "120%")
    ),
    cells_row_groups()
  ) |>
  cols_width(
    info ~ px(800),
    speakers ~ px(300)
  ) |>
  cols_align(align = "left", columns = everything()) |>
  cols_label(
    room = "Room",
    time = "Time",
    info = "Title, abstract, and more info",
    speakers = "Presenter(s)"
  ) |>
  tab_style(
    style = cell_text(weight = "bold"), 
    locations = cells_column_labels(everything())
  )
}
```

# Overview {orientation="columns"}

## Column - In-person {width="70%"}

In-person program

```{r}
#| label: valuebox-values-inperson
program_inperson <- program |> 
  filter(date != "2025-08-01")

program_inperson_counts <- program_inperson |>
  count(session) |>
  mutate(
    session_simplified = case_when(
      str_detect(session, "tutorial") ~ "Tutorial",
      str_detect(session, "Keynote") ~ "Keynote",
      session == "Poster" ~ "Poster",
      session == "Lightning" ~ "Lightning talk",
      .default = "Talk"
    ) 
  ) |>
  group_by(session_simplified) |>
  summarize(n = sum(n))
```

### Row - Value boxes {height="30%"}

```{r}
#| content: valuebox
#| title: "Keynotes"
list(
  icon = "mic-fill",
  color = "#FFD960",
  value = program_inperson_counts |> filter(session_simplified == "Keynote") |> pull(n)
)
```

```{r}
#| content: valuebox
#| title: "Tutorials"
list(
  icon = "code-square",
  color = "#2165b680",
  value = program_inperson_counts |> filter(session_simplified == "Tutorial") |> pull(n)
)
```

```{r}
#| content: valuebox
#| title: "Talks"
list(
  icon = "mic",
  color = "#2165b660",
  value = program_inperson_counts |> filter(session_simplified == "Talk") |> pull(n)
)
```

```{r}
#| content: valuebox
#| title: "Lightning talks"
list(
  icon = "lightning",
  color = "#2165b620",
  value = program_inperson_counts |> filter(session_simplified == "Lightning talk") |> pull(n)
)
```

```{r}
#| content: valuebox
#| title: "Posters"
list(
  icon = "clipboard",
  color = "#E2E6ED50",
  value = program_inperson_counts |> filter(session_simplified == "Poster") |> pull(n)
)
```

### Row - Themes {height="70%"}

```{r}
#| label: keyword-wordcloud-inperson
#| title: Emerging themes
#| renderings: [light, dark]
program_inperson_themes <- program_inperson |>
  separate_longer_delim(keywords, delim = ", ") |>
  mutate(keywords = str_trim(keywords)) |>
  filter(!is.na(keywords)) |>
  count(keywords, sort = TRUE) |>
  filter(n > 1)

ggplot(program_inperson_themes, aes(label = keywords, size = n, color = n)) +
  geom_text_wordcloud_area(rm_outside = TRUE) +
  scale_size_area(max_size = 30) +
  theme_minimal() +
  scale_color_gradient(low = "#81a3d9", high = "#3564b0")

ggplot(program_inperson_themes, aes(label = keywords, size = n, color = n)) +
  geom_text_wordcloud_area(rm_outside = TRUE) +
  scale_size_area(max_size = 30) +
  theme_minimal() +
  theme(plot.background = element_rect(fill = "#323232", color = "#323232")) +
  scale_color_gradient(low = "#81a3d9", high = "#ffffff")
```

## Column - Virtual {width="30%" title="Virtual program"}

Virtual program

```{r}
#| label: valuebox-values-virtual
program_virtual <- program |> 
  filter(date == "2025-08-01")

program_virtual_counts <- program_virtual |>
  count(session)
```

### Row - Value boxes {height="30%"}

```{r}
#| content: valuebox
#| title: "Talks"
list(
  icon = "mic",
  color = "#65b62160",
  value = program_virtual_counts |> filter(session == "Virtual") |> pull(n)
)
```

```{r}
#| content: valuebox
#| title: "Lightning Talks"
list(
  icon = "lightning",
  color = "#65b62120",
  value = program_virtual_counts |> filter(session == "Virtual Lightning") |> pull(n)
)
```

### Row - Themes {height="70%"}

```{r}
#| label: keyword-wordcloud-virtual
#| title: Emerging themes
#| renderings: [light, dark]
program_virtual_themes <- program_virtual |>
  separate_longer_delim(keywords, delim = ", ") |>
  mutate(keywords = str_trim(keywords)) |>
  filter(!is.na(keywords)) |>
  count(keywords, sort = TRUE) |>
  filter(n > 1)

ggplot(program_virtual_themes, aes(label = keywords, size = n, color = n)) +
  geom_text_wordcloud_area(rm_outside = TRUE) +
  scale_size_area(max_size = 60) +
  theme_minimal() +
  scale_color_gradient(low = "#b6ea8a", high = "#65b621")

ggplot(program_virtual_themes, aes(label = keywords, size = n, color = n)) +
  geom_text_wordcloud_area(rm_outside = TRUE) +
  scale_size_area(max_size = 60) +
  theme_minimal() +
  theme(plot.background = element_rect(fill = "#323232", color = "#323232")) +
  scale_color_gradient(low = "#b6ea8a", high = "#ffffff")
```

# Schedule

## Row - Info

Please note that all session times are listed below in EDT and the schedule is subject to change.

## Row - Tabsets of tables {.tabset}

```{r}
#| label: split-days
virtual <- program |> filter(date == "2025-08-01") |> select(!c(date, keywords))
day_1   <- program |> filter(date == "2025-08-08") |> select(!c(date, keywords))
day_2   <- program |> filter(date == "2025-08-09") |> select(!c(date, keywords))
day_3   <- program |> filter(date == "2025-08-10") |> select(!c(date, keywords))
```

::: {.card title="August 1, 2025 - Virtual"}

The following talks are virtual and will be streamed on YouTube Live.

```{r}
#| label: virtual-schedule
#| html-table-processing: none
virtual |>
  make_schedule(color = "#65b621") |>
  cols_hide(columns = room)
```
:::

::: {.card title="August 8, 2025 - Day 1"}

The following tutorials and posters will be presented in person at Duke University, Durham, NC.

```{r}
#| label: day1-schedule
#| html-table-processing: none
bind_rows(
  day_1 |> filter(session == "Morning tutorial"),
  day_1 |> filter(session == "Afternoon tutorial"),
  day_1 |> filter(session == "Keynote #1"),
  day_1 |> filter(session == "Poster")
) |>
  mutate(room = if_else(session == "Keynote #1", "Gross Hall 270", room)) |>
  make_schedule(color = "#2165b6")
```
:::

::: {.card title="August 9, 2025 - Day 2"}

The following tutorials and posters will be presented in person at Duke University, Durham, NC.

```{r}
#| label: day2-schedule
#| html-table-processing: none
make_schedule(day_2, color = "#2165b6")
```
:::

::: {.card title="August 10, 2025 - Day 3"}

The following tutorials and posters will be presented in person at Duke University, Durham, NC.

```{r}
#| label: day3-schedule
#| html-table-processing: none
make_schedule(day_3, color = "#2165b6")
```
:::

